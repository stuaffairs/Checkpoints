<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <style>
    body {
      background: linear-gradient(135deg, #1e3c72, #2a5298);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      font-family: "Prompt", sans-serif;
      color: #fff;
    }
    .card {
      background: #ffffff;
      color: #333;
      border-radius: 20px;
      padding: 30px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.2);
      width: 95%;
      max-width: 1000px;
      text-align: center;
    }
    h2 {
      font-weight: 700;
      color: #1e3c72;
      margin-bottom: 10px;
    }
    p.subtitle {
      color: #444;
      margin-bottom: 25px;
    }
    #resultTable th {
      background-color: #1e3c72;
      color: #fff;
      text-align: center;
    }
    #resultTable td {
      text-align: center;
      vertical-align: middle;
    }
    .btn-primary {
      background-color: #2a5298;
      border: none;
      border-radius: 50px;
      padding: 10px 25px;
      transition: 0.3s;
    }
    .btn-primary:hover {
      background-color: #1e3c72;
    }
    input.form-control {
      border-radius: 50px;
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="card">
    <h2>Checkpoints</h2>
    <p class="subtitle">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏Å‡πá‡∏ö ‡∏ß‡∏¥‡∏ä‡∏≤‡∏™‡∏±‡∏á‡∏Ñ‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤ ‡∏£‡∏´‡∏±‡∏™‡∏ß‡∏¥‡∏ä‡∏≤ ‡∏™32101</p>

    <!-- ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ -->
    <form id="searchForm" class="row g-3 justify-content-center mb-4">
      <div class="col-12 col-md-6">
        <input type="text" id="studentId" class="form-control" placeholder="üîç ‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô">
      </div>
      <div class="col-12 col-md-3">
        <button type="submit" class="btn btn-primary w-100">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
      </div>
    </form>

    <!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå -->
    <div class="table-responsive">
      <table id="resultTable" class="table table-bordered table-striped d-none">
        <thead>
          <tr>
            <th>‡∏´‡πâ‡∏≠‡∏á</th>
            <th>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà</th>
            <th>‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß</th>
            <th>‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</th>
            <th>‡∏™‡∏°‡∏∏‡∏î</th>
            <th>‡∏™1</th>
            <th>‡∏ï‡πâ‡∏°‡∏¢‡∏≥</th>
            <th>‡∏£‡∏ß‡∏°1</th>
            <th>‡∏ä10</th>
            <th>‡∏ú‡∏•5</th>
            <th>‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏Å‡∏ï‡πå</th>
            <th>‡∏£‡∏ß‡∏°2</th>
            <th>‡∏£‡∏ß‡∏°3</th>
            <th>‡∏™20</th>
            <th>‡∏ã‡πà‡∏≠‡∏°</th>
            <th>‡∏£‡∏ß‡∏°4</th>
            <th>‡∏ä‡∏∏‡∏°‡∏ä‡∏ô</th>
            <th>RCEP</th>
            <th>‡∏£‡∏ß‡∏°5</th>
            <th>Test</th>
            <th>‡πÉ‡∏ö‡∏á‡∏≤‡∏ô</th>
            <th>‡∏£‡∏ß‡∏°6</th>
            <th>‡∏£‡∏ß‡∏°7</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <script>
    // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
    document.getElementById("searchForm").addEventListener("submit", function(e){
      e.preventDefault();
      const studentId = document.getElementById("studentId").value.trim();
      if (!studentId) return;
      google.script.run.withSuccessHandler(showResults).searchStudent(studentId);
    });

    // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á
    function showResults(data) {
      const table = document.getElementById("resultTable");
      const tbody = table.querySelector("tbody");
      tbody.innerHTML = "";

      if (data.length === 0) {
        tbody.innerHTML = `<tr><td colspan="23" class="text-center text-danger">‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>`;
      } else {
        data.forEach(row => {
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${row["‡∏´‡πâ‡∏≠‡∏á"] || ""}</td>
            <td>${row["‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà"] || ""}</td>
            <td>${row["‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß"] || ""}</td>
            <td>${row["‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•"] || ""}</td>
            <td>${row["‡∏™‡∏°‡∏∏‡∏î"] || ""}</td>
            <td>${row["‡∏™1"] || ""}</td>
            <td>${row["‡∏ï‡πâ‡∏°‡∏¢‡∏≥"] || ""}</td>
            <td>${row["‡∏£‡∏ß‡∏°1"] || ""}</td>
            <td>${row["‡∏ä10"] || ""}</td>
            <td>${row["‡∏ú‡∏•5"] || ""}</td>
            <td>${row["‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏Å‡∏ï‡πå"] || ""}</td>
            <td>${row["‡∏£‡∏ß‡∏°2"] || ""}</td>
            <td>${row["‡∏£‡∏ß‡∏°3"] || ""}</td>
            <td>${row["‡∏™20"] || ""}</td>
            <td>${row["‡∏ã‡πà‡∏≠‡∏°"] || ""}</td>
            <td>${row["‡∏£‡∏ß‡∏°4"] || ""}</td>
            <td>${row["‡∏ä‡∏∏‡∏°‡∏ä‡∏ô"] || ""}</td>
            <td>${row["RCEP"] || ""}</td>
            <td>${row["‡∏£‡∏ß‡∏°5"] || ""}</td>
            <td>${row["Test"] || ""}</td>
            <td>${row["‡πÉ‡∏ö‡∏á‡∏≤‡∏ô"] || ""}</td>
            <td>${row["‡∏£‡∏ß‡∏°6"] || ""}</td>
            <td>${row["‡∏£‡∏ß‡∏°7"] || ""}</td>
          `;
          tbody.appendChild(tr);
        });
      }
      table.classList.remove("d-none");
    }
  </script>
</body>
</html>
