const SHEET_ID = "https://docs.google.com/spreadsheets/d/1ncVjnswPo3RqKb7pUjabeOHQ4WsIkFRCS_vC7STAmoc"; 
const SHEET_NAME = "คะแนนเก็บ";   // ชื่อชีท (แท็บ) ที่เก็บข้อมูล

function doGet(e) {
  return HtmlService.createHtmlOutputFromFile("index")
    .setTitle("ค้นหาคะแนนเก็บนักเรียน");
}

// ฟังก์ชันค้นหาจากเลขประจำตัว
function searchStudent(studentId) {
  const ss = SpreadsheetApp.openById(SHEET_ID);
  const sheet = ss.getSheetByName(SHEET_NAME);
  const data = sheet.getDataRange().getValues();
  const headers = data[0];
  const results = [];

  // Loop ข้อมูลตั้งแต่แถวที่ 2
  for (let i = 1; i < data.length; i++) {
    if (String(data[i][2]).trim() === String(studentId).trim()) {  // คอลัมน์ที่ 3 = เลขประจำตัว
      const rowObj = {};
      headers.forEach((h, j) => {
        rowObj[h] = data[i][j];
      });
      results.push(rowObj);
    }
  }
  return results;
}
